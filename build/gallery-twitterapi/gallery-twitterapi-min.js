YUI.add("gallery-twitterapi",function(d){var b=function(f){f=f||false;var e={};if(f.oauth_token&&f.oauth_token_secret){e.oauth_token=f.oauth_token;e.oauth_token_secret=f.oauth_token_secret;}if(f.oauth_consumer_key&&f.oauth_consumer_secret){e.oauth_consumer_key=f.oauth_consumer_key;e.oauth_consumer_secret=f.oauth_consumer_secret;}this.oauth=e;};function c(e){var f=[];d.each(e,function(i,h,g){if(h==="q"){f.push(h+"='"+i+"'");}else{f.push(h+"=@"+h);}});if(f.length>0){return" WHERE "+f.join(" AND ");}else{return"";}}function a(e){if(typeof e==="undefined"){e=[];}else{if(!d.Lang.isArray(e)){e=[e];}}return e;}b.prototype.search=function(f,g,e){e=e||{};if(e.count){e.rpp=e.count;delete e.count;}e.q=f;this._execYql("SELECT * FROM twitter.search"+c(e),function(h){var i=a(h.results.results);g(i);},e,false);};b.prototype.friends_timeline=function(f,e){this._execYql("SELECT * FROM twitter.status.timeline.friends"+c(e),function(g){var h=a(g.results.statuses.status);f(h);},e,true);};b.prototype.user_timeline=function(e,g,f){f=f||{};f.id=e;f.since_id=f.since_id||1;this._execYql("SELECT * FROM twitter.status.timeline.user"+c(f),function(h){var i=a(h.results.statuses.status);g(i);},f,true);};b.prototype.user_mentions=function(f,e){e=e||{};c(e);return false;this._execYql("SELECT * FROM twitter.status.mentions"+c(e),function(g){var h=a(g.results.statuses.status);f(h);},e,true);};b.prototype.user_favorites=function(g,f,e){e=e||{};e.id=g;this._execYql("SELECT * FROM twitter.favorites"+c(e),function(h){var i=a(h.results.statuses.status);f(i);},e,true);};b.prototype.user_lists=function(g,f,e){e=e||{};e.user=g;this._execYql("SELECT * FROM twitter.lists"+c(e),function(h){f(h.results.lists_list.lists.list);},e,true);};b.prototype.user_list_subscriptions=function(g,f,e){e=e||{};e.user=g;this._execYql("SELECT * FROM twitter.lists.subscriptions"+c(e),function(h){f(h.results.lists_list.lists.list);},e,true);};b.prototype.direct_messages_in=function(f,e){this._execYql("SELECT * FROM twitter.directmessages"+c(e),function(g){var h=a(g.results["direct-messages"]["direct_message"]);f(h);},e,true);};b.prototype.direct_messages_out=function(f,e){this._execYql("SELECT * FROM twitter.directmessages.sent"+c(e),function(g){var h=a(g.results["direct-messages"]["direct_message"]);f(h);},e,true);};b.prototype.saved_searches=function(f,e){this._execYql("SELECT * FROM twitter.search.saved"+c(e),function(h){var g=a(h.results.saved_searches.saved_search);f(g);},e,true);};b.prototype.access_token=function(f,e){this._execYql("SELECT * FROM twitter.oauth.accesstoken"+c(e),function(g){f(g.results.result);},e,true);};b.prototype.request_token=function(f,e){this._execYql("SELECT * FROM twitter.oauth.requesttoken"+c(e),function(g){f(g.results.result);},e,true);};b.prototype.followers=function(g,f,e){e=e||{};e.id=g;this._execYql("SELECT * FROM twitter.followers"+c(e),function(h){f(h.results.ids.id);},e,true);};b.prototype.following=function(g,f,e){e=e||{};e.id=g;this._execYql("SELECT * FROM twitter.friends"+c(e),function(h){f(h.results.ids.id);},e,true);};b.prototype.friendship=function(g,h,i,e){var e={},f=false;if(d.Lang.isNumber(+g)){e.source_id=g;}else{if(d.Lang.isString(g)){e.source_screen_name=g;}}if(d.Lang.isNumber(+h)){e.target_id=h;}else{if(d.Lang.isString(h)){e.target_screen_name=h;}}this._execYql("SELECT * FROM twitter.friendships"+c(e),function(j){i(j.results.relationship);},e,true);};b.prototype.profile=function(e,h,f){var f={},g=false;if(d.Lang.isNumber(+e)){f.id=e;}else{if(d.Lang.isString(e)){f.screen_name=e;}}this._execYql("SELECT * FROM twitter.users"+c(f),function(i){h(i.results.user);},f,false);};b.prototype.trends=function(g,e){var f='USE "https://raw.github.com/derek/yql-tables/aca55389847d80893347bdd8b2bbf165f6cc58ae/twitter/twitter.trends.xml" as twitter.trends;';this._execYql(f+"SELECT * FROM twitter.trends"+c(e),function(h){g(h.results.trends);},{},false);};b.prototype.ratelimit=function(f,e){this._execYql("SELECT * FROM twitter.account.ratelimit"+c(e),function(g){f(g.results.hash);},{},true);};b.prototype.update_status=function(e,g){var f='USE "https://github.com/derek/yui-twitter/raw/master/datatables/twitter.status.xml" as post_twitter_status;';this._execYql(f+"UPDATE post_twitter_status SET status=@status WHERE "+this._oauth_to_where(),function(h){if(g){g(h);}},{status:e},false);};b.prototype._execYql=function(f,j,h,g){f=f||false;j=j||false;h=h||{};g=g||false;var e={proto:"http"},i=[];if(g){e={proto:"https"};for(key in this.oauth){i.push("SET "+key+"='"+this.oauth[key]+"' ON twitter; ");}}i=i.join("");yqlStatement=i+f;new d.YQL(yqlStatement,function(k){if(j){j(k.query);}},h,e);};b.prototype._oauth_to_where=function(){var e=[];for(key in this.oauth){e.push(key+"='"+this.oauth[key]+"'");}return e.join(" AND ");};d.Twitter=function(e){return new b(e);};},"@VERSION@",{requires:["yql"]});